!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var i=n(1),s=null;marked.setOptions({highlight:function(t){return hljs.highlightAuto(t).value}});var r=new Vue({el:"#markdown",data:{sourceContent:"",isFullScreenPreview:!1,isFullScreenEdit:!1,isSaved:!1,isHighLightLoaded:!1,setting:{domStyle:"none",space:"",ak:"",sk:"",domain:"",token:""}},methods:{toggleFullScreenEdit:function(){this.isFullScreenEdit=!this.isFullScreenEdit,this.isFullScreenEdit?this.$el.classList.add("fullscreen-edit"):(this.$el.classList.remove("fullscreen-edit"),this.sourceContent+=" ")},toggleFullScreenPreview:function(){this.isFullScreenPreview=!this.isFullScreenPreview,this.isFullScreenPreview?this.$el.classList.add("fullscreen-preview"):this.$el.classList.remove("fullscreen-preview")},save:function(){0==this.isSaved&&(window.localStorage.setItem("markdown-text",this.sourceContent),this.isSaved=!0)},tabHandler:function(t){var e=t.target,n=e.value,i=e.selectionStart,s=e.selectionEnd,r=n.slice(0,i)+"    "+n.slice(s);e.value=r,e.selectionStart=i+4,e.selectionEnd=i+4},print:function(){window.print()},saveSetting:function(){if(!(this.setting.space&&this.setting.ak&&this.setting.sk&&this.setting.domain))return void alert("以上四项都必须填写");var t=i(this.setting.space,this.setting.ak,this.setting.sk),e={space:this.setting.space,ak:this.setting.ak,sk:this.setting.sk,domain:this.setting.domain,token:t};this.setting.token=t,localStorage.setItem("qiniu",JSON.stringify(e)),this.setting.domStyle="none",s?(s.destroy(),this.initUpload()):this.initUpload()},readSetting:function(){var t=localStorage.getItem("qiniu");t&&(t=JSON.parse(t),this.setting.space=t.space,this.setting.ak=t.ak,this.setting.sk=t.sk,this.setting.domain=t.domain,this.setting.token=t.token),this.setting.domStyle="none"},initUpload:function(){var t=this;s=Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:"js-upload-image",uptoken:t.setting.token,unique_names:!1,domain:t.setting.domain,get_new_uptoken:!1,container:"js-drag-container",max_file_size:"10mb",flash_swf_url:"https://cdn.staticfile.org/Plupload/2.1.1/Moxie.swf",max_retries:3,dragdrop:!0,drop_element:"js-drag-container",chunk_size:"4mb",auto_start:!0,filters:{mime_types:[{title:"Image files",extensions:"jpg,jpeg,png,bmp,gif"}],max_file_size:"10mb",prevent_duplicates:!0},init:{BeforeUpload:function(e,n){var i=n.name.split(".")[0],s="!["+i+"正在上传...]",r=document.getElementById("js-textarea"),o=r.selectionStart,a=r.selectionEnd,l=t.sourceContent,c=l.slice(0,o)+"\n"+s+"\n"+l.slice(a);t.sourceContent=c,r.selectionStart=o+s.length,r.selectionEnd=o+s.length},FileUploaded:function(e,n,i){var s=e.getOption("domain"),r="http://"+s+"/"+JSON.parse(i).key,o="!["+n.name.split(".")[0]+"正在上传...]",a="!["+n.name.split(".")[0]+"]("+r+")";t.sourceContent=t.sourceContent.replace(o,a)},Error:function(e,n,i){n.code==-602?alert("你已经上传过这张图片了"):e.files.forEach(function(e){var n="!["+e.name.split(".")[0]+"正在上传...]",i="!["+e.name.split(".")[0]+"](上传失败)";t.sourceContent=t.sourceContent.replace(n,i)})},UploadComplete:function(){},Key:function(t,e){var n=new Date,i=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+"/"+((n.valueOf()*Math.random()).toFixed(0)+"").substr(0,6);return i+"."+e.name.split(".")[1]}}})}},mounted:function(){this.readSetting();var t=window.localStorage.getItem("markdown-text");if(t)this.$nextTick(function(){this.sourceContent=t});else{var e;e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e.open("GET","src/example.md"),e.send(),e.onreadystatechange=function(){4==e.readyState&&200==e.status&&(this.sourceContent=e.responseText)}}setInterval(this.save,3e3),window.addEventListener("unload",this.save,!1),this.setting.token&&this.initUpload()}});r.$watch("sourceContent",function(t){if(!this.isFullScreenEdit){var e=document.getElementById("dist");e.innerHTML=marked(t)}this.isSaved=!1})},function(t,e){function n(t,e,n){function i(t){var e,n,i,s;for(e="",i=t.length,n=0;n<i;n++)s=t.charCodeAt(n),s>=1&&s<=127?e+=t.charAt(n):s>2047?(e+=String.fromCharCode(224|s>>12&15),e+=String.fromCharCode(128|s>>6&63),e+=String.fromCharCode(128|s>>0&63)):(e+=String.fromCharCode(192|s>>6&31),e+=String.fromCharCode(128|s>>0&63));return e}function s(t){var e,n,i,s,o,a;for(i=t.length,n=0,e="";n<i;){if(s=255&t.charCodeAt(n++),n==i){e+=r.charAt(s>>2),e+=r.charAt((3&s)<<4),e+="==";break}if(o=t.charCodeAt(n++),n==i){e+=r.charAt(s>>2),e+=r.charAt((3&s)<<4|(240&o)>>4),e+=r.charAt((15&o)<<2),e+="=";break}a=t.charCodeAt(n++),e+=r.charAt(s>>2),e+=r.charAt((3&s)<<4|(240&o)>>4),e+=r.charAt((15&o)<<2|(192&a)>>6),e+=r.charAt(63&a)}return e}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",o=(new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1),function(t){return t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_")}),a=JSON.stringify({scope:t,deadline:1793791775}),l=s(i(a)),c=CryptoJS.HmacSHA1(l,n),d=c.toString(CryptoJS.enc.Base64),u=e+":"+o(d)+":"+l;return u}t.exports=n}]);